# Метод близнецов (Buddy system)
Детали реализации
- Для реализации системы близнецов использовалась древовидная структура данных.
- Прежде всего создайте один узел дерева размером 64 КБ, а затем войдите в цикл, который будет выполняться 10 000 раз.
- Запустите случайное выделение и освобождение в этом цикле, вызвав соответствующие функции на основе остатка функции rand.
- Когда вызывается функция распределения, генерируется процесс случайного размера, и вычисляется ближайшее значение в степени 2, что помогает при необходимости разбить дерево.
- На основе вычисленного значения блок требуемого размера сначала ищется в свободном списке только этой степени числа 2, если блок найден, то процесс вставляется в этот блок, свободное пространство, оставшееся после выделения процесса в этом блоке, вычисляется для последующего использования.
- Если блок нужного размера не находится в свободном списке, то блок большего размера разбивается на два, и процесс разбиения продолжается до тех пор, пока не произойдет совпадение с ближайшей степенью двойки.
- Когда вызывается функция отмены распределения, блок, который был выделен процессу, выбирается случайным образом при анализе дерева.
- Пространство, выделенное процессу, освобождается и вызывается рекурсивная функция, которая проверяет, возможно ли слияние близнецов или нет.
- Рекурсивная функция движется от листьев к корню и пытается объединить двух близнецов, если они свободны. Список также обновляется для каждого уровня степени 2.

# Образец вывода

В приведенном ниже контексте показаны результаты нескольких запусков программы:



Sample Run 1

Internal Fragmentation (KB)= 15 ----- % 0.234375

hash of Allocation Requests Denied = 9087

External Fragmentation = 0

----------------

Sample Run 2

Internal Fragmentation (KB)= 8 -----% 0.125

hash of Allocation Requests Denied = 5971

External Fragmentation = 0

----------------

Sample Run 3

Internal Fragmentation (KB)= 2 -----% 0.03125

hash of Allocation Requests Denied = 0

External Fragmentation = 0

----------------

Sample Run 4

Internal Fragmentation (KB)= 16 -----% 0.25

hash of Allocation Requests Denied = 6422

External Fragmentation = 0

----------------

Sample Run 5

Internal Fragmentation (KB)= 28 -----% 0.4375

hash of Allocation Requests Denied = 4990

External Fragmentation = 0



# Наблюдения в ходе реализации
- Объем пространства, потерянного в результате внутренней фрагментации, зависит от размера процесса.
- Если метод близнецов загружается процессом большего размера, то пространство, потраченное впустую в результате внутренней фрагментации, больше, потому что этим процессам выделяются более крупные блоки.
- Количество отклоненных запросов на выделение больше, но обычно оно зависит от того, как выделения и отмены распределения накладываются друг на друга.
- Внешняя фрагментация в системе близнецов всегда будет нулевой.
- Когда процесс удаляется, возникают дополнительные затраты на проверку близнецов до корневого узла для слияния, что делает этот метод медленнее.
